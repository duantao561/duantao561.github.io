---
title: 人工智能(12)--蛋白质二级结构预测
date: 2019-08-23 15:03:03
tags:
  - 人工智能
categories: 
  - 人工智能
---

给定一串氨基酸序列，预测其折叠后的二级结构
## 题目介绍

蛋白质折叠问题是生物信息学中最重要的板块之一,而其中最受人关注的毫无疑问是:如何根据给定的氨基酸序列预测其对应的蛋白质结构。

一个蛋白质分子的生物学性质与其三维结构存在着密不可分的关系,而蛋白质的天然三维结构正是由氨基酸单体的链式结构折叠而来。然而事实证明,从氨基酸序列直接预测蛋白质空间结构往往效果不佳。

因此,在这道题中，请尝试使用课上所学过的模型，以及主流的深度深度学习框架，将其运用于预测蛋白质的二级结构中,从而在一级链式
结构与三级空间结构中架起一座桥梁。

### 题目描述

氨基酸序列是一串由多个氨基酸单体排列组成的链式结构。一共有20种常见的氨基酸单体，其单个字母缩写表示为：[A R N D C Q E G H I L K M F P S T W Y V]。而每一条氨基酸序列在折叠成蛋白质的过程中，会逐渐显现出其二级结构，在这里我们使用较为简单的3分类模型：[α-螺旋，β-折叠以及无规卷曲（random coil）]，分别用[H，E，C]来表示。

当一条氨基酸序列经过折叠后，序列中不同的区域会显现出不同的二级结构，因此，序列中的每个氨基酸单体都可以找到其对应的二级结构类型，而相邻的氨基酸单体往往会属于同一个二级结构，因为不论是α-螺旋还是β-折叠，都是多个氨基酸单体折叠在一起后才产生的结构。

在本题中，请你使用给定的氨基酸序列及其对应二级结构作为训练数据，将其预处理成你所需要的数据格式后，训练出一个分类器，用于蛋白质二级结构的预测。

### 注意事项

1. 因为本次月考是人工智能训练营的最后一次月考，也是最后一次大作业，所以本题中给出的数据会更加接近现实，题目也变得更有挑战性。

2. 源文件将是一个只经过些许预处理的txt文件，因此你需要根据你的网络结构，来自行预处理数据。例如：如何提取X_train, 和Y_train？是将整个训练集保存为一个文件，还是多个文件？是否自行encoding，还是使用开源框架的内置函数？所有的操作都将由你的模型来决定。

3. 鼓励使用tensorflow或是pytorch等开源框架，因为其提供了自动微分功能，极大地降低了训练的难度，同时他们提供的tutorials是非常、非常有帮助的。

4. 建议从最简单的neural network训练起，再尝试CNN，RNN等复杂模型。有时候，简单的或许是最好的 ；）

## 评价

你提交的`submission.csv`文件，将使用[准确率(accuracy)]作为最后评判标准。

准确率(accuracy)是用来衡量算法预测结果的准确程度，具体指测试集中算法预测正确的数量占总数的比例。

$$ Accuracy=\frac{Number of Correct Predictions}{Number of Total Predictions} $$

* 在本题中，我们将二级结构分为3类（α-螺旋，β-折叠以及无规卷曲（random coil））。因此每一个氨基酸的二级结构预测值都应当属于这3类之一。

* 在统计准确率时，这里我们将比较每一条氨基酸序列中，每一个氨基酸单体所对应的二级结构预测值和真实值。即，在一条长度为k的氨基酸序列中，它包含k个氨基酸单体，其number of prediction = k。 因此，Number of Correct Predictions为你预测正确的氨基酸单体的总个数，而Number of Total Predictions为所有的氨基酸序列的长度总和，accuracy_score即为此二者之比。

## 输入格式

在这里我们给出了两个txt文件，分别是训练集：ss100_train.txt和测试集：ss100_test.txt。训练集（training set）包含10000条氨基酸序列以及其对应的二级结构，而测试集（test set）中只包含了400条氨基酸序列，用于最终预测并上传答案。每一条氨基酸序列的长度在[50,100]之间。

ss100_train.txt中数据以如下形式储存：氨基酸序列数据以4行为一周期，其中第1、3行是标签，用来告诉你该氨基酸序列的ID，以及下一行是氨基酸序列还是其对应的二级结构。4行中的第2行是氨基酸单体序列，第4行是其对应的二级结构。

举例来说：
>1A1Y:I:sequence
KTEWPELVGKSVEEAKKVILQDKPEAQIIVLPVGTIVTMEYRIDRVRLFVDKLDNIAEVPRVG
>1A1Y:I:secstr
CCECHHHCCCEHHHHHHHHHHHCCCCEEEEEECCCEEECCCCCCEEEEEECCCCEECCCCEEC

第一行表示这个氨基酸序列代号为：1A02:J，sequence表示它的下一行是amino acid sequence，即氨基酸序列；第二行是该氨基酸序列的字母缩写表达；第三行里的secstr为Secondary Structure的缩写，表示下一行是该氨基酸序列所对应的二级结构；第四行就是其二级结构的字母缩写表达。

第二行的氨基酸单体字母缩一共有20种可能，为：[A R N D C Q E G H I L K M F P S T W Y V]。而第四行中的二级结构一共有3类——[H，E，C]，其分别代表[α-螺旋，β-折叠以及无规卷曲（random coil）]。

请注意，第二行与第四行的长度一定是完全相同的，因为每一个氨基酸单体都会在二级结构中找到其对应的分类。因此，简而言之，你所需要做的事就是找到一个分类器，帮助预测氨基酸序列中的每一个单体，所对应的二级结构类型。

需要注意的是，因为这里提供的是txt文件，因此你需要手动将其转换成适合神经网络读入的格式。另外，因为训练集中包含了10000条训练数据，所以有需要的话可以将其划分为训练集（training set）以及验证集（dev set），来进行交叉验证（k-fold Cross Validation）等。一些别的建议请参考题目描述中的*注意事项*板块。


## 输出格式

当你训练完一个有效的分类器后（可以是神经网络或其他任何你熟悉的分类器），请将自行预处理过的测试集数据作为分类器的输入，并将输出存储在提交的csv文件中。

提交的csv文件应采用以下格式：一共只包含1列—class，代表所预测的所有氨基酸序列的每个单体的二级结构。由于氨基酸序列的长度各不相同（[50,100])，因此请按ss100_test.txt中的顺序，将所有的输出reshape成1列，并存在class里。具体来说，就是将每一个氨基酸序列的预测结果先转化为（-1，1）的格式，再将不同的氨基酸序列的预测结果竖直拼接在一起，最终成为一列。最终拼接后的列向量的长度应为(32508,1）。
可参看提供的sample\_submission.csv

！！！请注意：为了便于批改，在输出中，请用”0“代表”H“，“1”代表“E”，”2“代表”C“。 因此，提交的文件中除了第一行为”class“外，其余内容应该都为”0“，"1“或”2“

！！！再次强调：请按ss100_test.txt中氨基酸序列的顺序输出预测，不然即使总长度对了，中间对应的氨基酸不对应也是无效的。

若对上述表达仍有困惑，此段代码仅供参考。
y_pred.reshape(-1, 1)
data = pd.DataFrame({'class': y_pred})
data.to_csv('submit.csv', index=False)